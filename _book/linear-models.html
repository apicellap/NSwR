<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 6 Linear models | A Guide to The New Statistics with R</title>
<meta name="author" content="Pete Apicella">
<meta name="generator" content="bookdown 0.27 with bs4_book()">
<meta property="og:title" content="Chapter 6 Linear models | A Guide to The New Statistics with R">
<meta property="og:type" content="book">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 6 Linear models | A Guide to The New Statistics with R">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.3.1/transition.js"></script><script src="libs/bs3compat-0.3.1/tabs.js"></script><script src="libs/bs3compat-0.3.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<link rel="stylesheet" href="style.css">
<meta name="description" content="Chapter 5 introduced Darwin’s maize data, and the manual calculation of confidence intervals (CIs) In this chapter, the author discusses more efficient methods of calculating CIs  6.1 Introduction...">
<meta property="og:description" content="Chapter 5 introduced Darwin’s maize data, and the manual calculation of confidence intervals (CIs) In this chapter, the author discusses more efficient methods of calculating CIs  6.1 Introduction...">
<meta name="twitter:description" content="Chapter 5 introduced Darwin’s maize data, and the manual calculation of confidence intervals (CIs) In this chapter, the author discusses more efficient methods of calculating CIs  6.1 Introduction...">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">A Guide to The New Statistics with R</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">About</a></li>
<li><a class="" href="introduction.html"><span class="header-section-number">1</span> Introduction</a></li>
<li><a class="" href="motivation.html"><span class="header-section-number">2</span> Motivation</a></li>
<li><a class="" href="description.html"><span class="header-section-number">3</span> Description</a></li>
<li><a class="" href="reproducible-research.html"><span class="header-section-number">4</span> Reproducible Research</a></li>
<li><a class="" href="estimation.html"><span class="header-section-number">5</span> Estimation</a></li>
<li><a class="active" href="linear-models.html"><span class="header-section-number">6</span> Linear models</a></li>
<li><a class="" href="regression.html"><span class="header-section-number">7</span> Regression</a></li>
<li><a class="" href="prediction.html"><span class="header-section-number">8</span> Prediction</a></li>
<li><a class="" href="testing.html"><span class="header-section-number">9</span> Testing</a></li>
<li><a class="" href="intervals.html"><span class="header-section-number">10</span> Intervals</a></li>
<li><a class="" href="analysis-of-variance.html"><span class="header-section-number">11</span> Analysis of Variance</a></li>
<li><a class="" href="factorial-designs.html"><span class="header-section-number">12</span> Factorial designs</a></li>
<li><a class="" href="analysis-of-covariance.html"><span class="header-section-number">13</span> Analysis of Covariance</a></li>
<li><a class="" href="linear-model-complexities.html"><span class="header-section-number">14</span> Linear Model Complexities</a></li>
<li><a class="" href="generalized-linear-models-glms.html"><span class="header-section-number">15</span> Generalized Linear Models (GLMs)</a></li>
<li><a class="" href="glms-for-count-data.html"><span class="header-section-number">16</span> GLMs for Count Data</a></li>
<li><a class="" href="binomial-glms.html"><span class="header-section-number">17</span> Binomial GLMs</a></li>
<li><a class="" href="glms-for-binary-data.html"><span class="header-section-number">18</span> GLMs for binary data</a></li>
<li><a class="" href="conclusions.html"><span class="header-section-number">19</span> Conclusions</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/apicellap/NSwR.git">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="linear-models" class="section level1" number="6">
<h1>
<span class="header-section-number">6</span> Linear models<a class="anchor" aria-label="anchor" href="#linear-models"><i class="fas fa-link"></i></a>
</h1>
<ul>
<li>Chapter 5 introduced Darwin’s maize data, and the manual calculation of confidence intervals (CIs)</li>
<li>In this chapter, the author discusses more efficient methods of calculating CIs</li>
</ul>
<div id="introduction-3" class="section level2" number="6.1">
<h2>
<span class="header-section-number">6.1</span> Introduction<a class="anchor" aria-label="anchor" href="#introduction-3"><i class="fas fa-link"></i></a>
</h2>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"DAAG"</span>, repos <span class="op">=</span> <span class="st">"https://cran.us.r-project.org"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"ggfortify"</span>,  repos <span class="op">=</span> <span class="st">"https://cran.us.r-project.org"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"SMPracticals"</span>,  repos <span class="op">=</span> <span class="st">"https://cran.us.r-project.org"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"ggplot2"</span>,  repos <span class="op">=</span> <span class="st">"https://cran.us.r-project.org"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"arm"</span>,  repos <span class="op">=</span> <span class="st">"https://cran.us.r-project.org"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"reshape2"</span>,  repos <span class="op">=</span> <span class="st">"https://cran.us.r-project.org"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"tidyverse"</span>,  repos <span class="op">=</span> <span class="st">"https://cran.us.r-project.org"</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://CRAN.R-project.org/package=arm">arm</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://gitlab.com/daagur">DAAG</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/sinhrks/ggfortify">ggfortify</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://statwww.epfl.ch/davison/SM/">SMPracticals</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/hadley/reshape">reshape2</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></code></pre></div>
</div>
<div id="a-linear-model-analysis-for-comparing-groups" class="section level2" number="6.2">
<h2>
<span class="header-section-number">6.2</span> A linear model analysis for comparing groups<a class="anchor" aria-label="anchor" href="#a-linear-model-analysis-for-comparing-groups"><i class="fas fa-link"></i></a>
</h2>
<ul>
<li>The general function for creating linear models is <code><a href="https://rdrr.io/r/stats/lm.html">lm()</a></code>
</li>
<li>It’s good practice to assign a model to an object (i.e. ls0)
<ul>
<li>Short for least squares model 0 because the linear model analysis uses a technique known as least squares</li>
</ul>
</li>
</ul>
<p>Create first model:</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ls0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="va">height</span> <span class="op">~</span><span class="fl">1</span>,  <span class="co">#the 1 indicates that we just want to</span>
                                  <span class="co">#estimate an intercept</span>
          data <span class="op">=</span> <span class="va">darwin</span><span class="op">)</span> </code></pre></div>
<ul>
<li>ls0 is a model of height in relation to 1 (not another variable)</li>
<li>When no comparisons are made in the model the intercept equals the grand mean</li>
</ul>
<p>Generate a concise summary (table of coefficients) of key output of linear models:</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/arm/man/display.html">display</a></span><span class="op">(</span><span class="va">ls0</span><span class="op">)</span> <span class="co">#from the arm package</span>
<span class="co">#&gt; lm(formula = height ~ 1, data = darwin)</span>
<span class="co">#&gt;             coef.est coef.se</span>
<span class="co">#&gt; (Intercept) 18.88     0.58  </span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; n = 30, k = 1</span>
<span class="co">#&gt; residual sd = 3.18, R-Squared = 0.00</span></code></pre></div>
<ul>
<li>display(ls0) output:
<ul>
<li>
<strong>coeff.est</strong> = the intercept (it’s the grand mean in this case)</li>
<li>
<strong>coeff.se</strong> = the standard error</li>
<li>
<strong>n</strong> = sample size</li>
<li>
<strong>k</strong> = # of parameters estimated by the model
(in this case it’s 1 since it’s just the grand mean)</li>
<li>
<strong>residual sd</strong> = the SD of the heights of all 30 plants</li>
<li>
<strong>R-squared</strong> 0.00 = 0% of the variation in the data is accounted for by the
explanatory variable since there is no explanatory variable, the proportion is 0%</li>
</ul>
</li>
</ul>
<p>The intercept is the grand mean of all of the Darwin maize data. Confirmation:</p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">x</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/format.html">format</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">darwin</span><span class="op">$</span><span class="va">height</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span>, nsmall <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>
<span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>
<span class="va">x</span>
<span class="co">#&gt; [1] 18.88</span></code></pre></div>
<p>Visualize the data:</p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">base_plot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">darwin</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">type</span>, y <span class="op">=</span> <span class="va">height</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span>
<span class="va">base_plot</span>  <span class="co"># the marked points are outliers </span></code></pre></div>
<div class="inline-figure"><img src="06_linear-models_files/figure-html/maize-viz-06-1.png" width="672"></div>
<p>Create model of height by pollination type:</p>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ls1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">height</span> <span class="op">~</span> <span class="va">type</span>, data <span class="op">=</span> <span class="va">darwin</span><span class="op">)</span> <span class="co">#does height vary as a function of type of pollination? </span></code></pre></div>
<p>Summarize the model ls1:</p>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/arm/man/display.html">display</a></span><span class="op">(</span><span class="va">ls1</span><span class="op">)</span>
<span class="co">#&gt; lm(formula = height ~ type, data = darwin)</span>
<span class="co">#&gt;             coef.est coef.se</span>
<span class="co">#&gt; (Intercept) 20.19     0.76  </span>
<span class="co">#&gt; typeSelf    -2.62     1.07  </span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; n = 30, k = 2</span>
<span class="co">#&gt; residual sd = 2.94, R-Squared = 0.18</span></code></pre></div>
<ul>
<li>display(ls1) output:
<ul>
<li>Need to figure out what “<strong>Intercept</strong>” is in the table of coefficients
<ul>
<li>It is no longer equal to the grand mean</li>
</ul>
</li>
<li>There are two levels encompasses in the explanatory variable “type”
<ul>
<li>One is “self” and is listed as typeSelf</li>
<li>So the intercept must be the other explanatory variable (cross)
<ul>
<li>Also, R lists levels in alphabetical order (cross before self)</li>
</ul>
</li>
</ul>
</li>
<li>In the table, the <strong>coeff.est</strong> of the intercept is the average height of cross pollinated progeny
<ul>
<li>
<strong>coef.se</strong> of the Intercept is the SE of the mean</li>
</ul>
</li>
<li>The <strong>coeff.est</strong> of typeSelf is the difference in mean height of the cross pollinated and self pollinated progeny (that’s why it is negative)</li>
<li>This will help us answer the question, Is there any difference in plant height that results from the different pollination treatments?
<ul>
<li>The <strong>coeff.se</strong> for typeSelf is also something new:</li>
<li>It’s the standard error of the difference
<ul>
<li>Variation expected around the difference</li>
</ul>
</li>
</ul>
</li>
<li>The linear model calculates a pooled variation across all groups to take advantage of the fuller sample (greater n)
<ul>
<li>Assumes that the groups have the same variance; this assumption must be checked</li>
</ul>
</li>
<li>
<strong>residual sd</strong> - square root of the residual error variance</li>
<li>
<strong>R-squared</strong> - 18% of the variation is explained by the pollination variable</li>
</ul>
</li>
</ul>
<p>Annotate mean on scatterplot:</p>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">darwin</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">type</span>, y <span class="op">=</span> <span class="va">height</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>  
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/stat_summary.html">stat_summary</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="va">mean</span>, <span class="co">#superimpose the mean on the plot </span>
               geom <span class="op">=</span> <span class="st">"point"</span>, 
               colour <span class="op">=</span> <span class="st">"blue"</span>, shape <span class="op">=</span><span class="fl">8</span>, size <span class="op">=</span><span class="fl">5</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="06_linear-models_files/figure-html/scatterp-06-1.png" width="672"></div>
</div>
<div id="standard-error-of-the-difference" class="section level2" number="6.3">
<h2>
<span class="header-section-number">6.3</span> Standard error of the difference<a class="anchor" aria-label="anchor" href="#standard-error-of-the-difference"><i class="fas fa-link"></i></a>
</h2>
<ul>
<li>Standard error of the difference (SED) - standard error of the difference between two means:</li>
</ul>
<center>
<span class="math inline">\(SED = \sqrt{\frac{s_1^2}{n_1} + \frac{s_2^2}{n_2}}\)</span>
</center>
<ul>
<li>The subscripts indicate there are two groups (i.e. treatment groups)</li>
</ul>
</div>
<div id="confidence-intervals-1" class="section level2" number="6.4">
<h2>
<span class="header-section-number">6.4</span> Confidence intervals<a class="anchor" aria-label="anchor" href="#confidence-intervals-1"><i class="fas fa-link"></i></a>
</h2>
<p>Calculate upper and lower bounds of the CI for the model:</p>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">CI_ls1</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html">confint</a></span><span class="op">(</span><span class="va">ls1</span><span class="op">)</span>
<span class="va">CI_ls1</span>
<span class="co">#&gt;                2.5 %     97.5 %</span>
<span class="co">#&gt; (Intercept) 18.63651 21.7468231</span>
<span class="co">#&gt; typeSelf    -4.81599 -0.4173433</span></code></pre></div>
<ul>
<li>Output:
<ul>
<li>Similar output to the <code><a href="https://rdrr.io/pkg/arm/man/display.html">display()</a></code> function</li>
<li>The first row (the Intercept) shows the 95% CI for the height of the seed developed from outcrossing</li>
<li>The second row shows the 95% CI for the difference in height between the two groups</li>
</ul>
</li>
<li>The upper (97.5%) and lower (2.5%) bounds are percentiles of the normal distribution</li>
<li>Helpful to incorporate all the data into one table:</li>
</ul>
<div class="inline-figure"><img src="table6_1.png" width="65%"></div>
<ul>
<li>Darwin hypothesized that progeny produced through selfing would have lower fitness levels (reflected in height)</li>
<li>CIs can be used to figure out if this is reflected in the data</li>
</ul>
</div>
<div id="answering-darwins-question" class="section level2" number="6.5">
<h2>
<span class="header-section-number">6.5</span> Answering Darwin’s question<a class="anchor" aria-label="anchor" href="#answering-darwins-question"><i class="fas fa-link"></i></a>
</h2>
<ul>
<li>The null hypothesis in this experiment is that there is no difference in fitness (height) of the progeny produced through selfing or outcrossing</li>
<li>A confidence interval test can be used to uphold or reject the null hypothesis
<ul>
<li>This requires that we determine if the predicted null value (zero) lies inside the confidence interval (see figure 5.3)</li>
<li>If zero lies outside these bounds, then the null hypothesis can be rejected at that confidence interval because the estimated mean difference (-2.62 inches) can be distinguished from the null predicted value given the variability in the data</li>
<li>Variability in the data is quantified through the standard error, which is used to calculate the CI</li>
</ul>
</li>
<li>We can visualize this on a numberline</li>
</ul>
<p>Plot a number line with difference of means and its respective CI:
(see <a href="https://rdrr.io/cran/coefplot/man/coefplot.default.html">guide</a>)</p>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">figu6_4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/arm/man/coefplot.html">coefplot</a></span><span class="op">(</span><span class="va">ls1</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">5</span>,<span class="fl">0</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="06_linear-models_files/figure-html/numline-ls1-06-1.png" width="672"></div>
<ul>
<li>Number line conclusions:
<ul>
<li>since 0 is outside the 95% CI, we can reject the null hypothesis at this standard</li>
</ul>
</li>
</ul>
<p>Create a model with a 99% CI requirement:</p>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/confint.html">confint</a></span><span class="op">(</span><span class="va">ls1</span>, level <span class="op">=</span> <span class="fl">0.99</span><span class="op">)</span>
<span class="co">#&gt;                 0.5 %     99.5 %</span>
<span class="co">#&gt; (Intercept) 18.093790 22.2895433</span>
<span class="co">#&gt; typeSelf    -5.583512  0.3501789</span></code></pre></div>
<ul>
<li>Output:
<ul>
<li>note the change in sign in the upper bound of typeSelf shows that 0 is now within the CI</li>
</ul>
</li>
</ul>
<p>Redraw the number line with the new model:</p>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">fig6_5</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/arm/man/coefplot.html">coefplot</a></span><span class="op">(</span><span class="va">ls1</span>,  
                   sd <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="co">#sd actually refers the # of standard errors here </span></code></pre></div>
<div class="inline-figure"><img src="06_linear-models_files/figure-html/numline99-ls1-06-1.png" width="672"></div>
<ul>
<li>Conclusions:
<ul>
<li>cannot reject the null hypothesis at a 99% CI as 0 is within it</li>
</ul>
</li>
</ul>
</div>
<div id="relevelling-to-get-the-other-treatment-mean-and-standard-error" class="section level2" number="6.6">
<h2>
<span class="header-section-number">6.6</span> Relevelling to get the other treatment mean and standard error<a class="anchor" aria-label="anchor" href="#relevelling-to-get-the-other-treatment-mean-and-standard-error"><i class="fas fa-link"></i></a>
</h2>
<ul>
<li>A limitation of these methods is that the table of coefficients from <code><a href="https://rdrr.io/pkg/arm/man/display.html">display()</a></code> will not produce the mean and standard error for another level
<ul>
<li>As we have seen, you can only get the difference of means and the SED</li>
</ul>
</li>
<li>To find the mean and standard error for the other level(s), the variables have to be relevelled</li>
</ul>
<p>Relevel to get the mean and standard error data for the selfed progeny population:</p>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">darwin</span><span class="op">$</span><span class="va">type</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/relevel.html">relevel</a></span><span class="op">(</span><span class="va">darwin</span><span class="op">$</span><span class="va">type</span>, <span class="co">#in this column:</span>
                       ref <span class="op">=</span> <span class="st">"Self"</span><span class="op">)</span> <span class="co">#make the reference the Self group </span></code></pre></div>
<p>Summarize the model:</p>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/arm/man/display.html">display</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">height</span> <span class="op">~</span><span class="va">type</span>, data <span class="op">=</span> <span class="va">darwin</span><span class="op">)</span><span class="op">)</span> <span class="co">#now, Intercept's coef.est and coef.se refer to those of the selfed population </span>
<span class="co">#&gt; lm(formula = height ~ type, data = darwin)</span>
<span class="co">#&gt;             coef.est coef.se</span>
<span class="co">#&gt; (Intercept) 17.58     0.76  </span>
<span class="co">#&gt; typeCross    2.62     1.07  </span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; n = 30, k = 2</span>
<span class="co">#&gt; residual sd = 2.94, R-Squared = 0.18</span></code></pre></div>
<ul>
<li>The standard error of the mean (Intercept$coef.se) is the same for typeSelf as for typeCross (0.76)
<ul>
<li>Based on the formula for SE, SE value depends on <span class="math inline">\(variance^2\)</span> and the sample size (n) for each group</li>
<li>However, R’s <code><a href="https://rdrr.io/r/stats/lm.html">lm()</a></code> function uses a single (pooled) estimate of the residual variance for all treatment levels (this concept will be revisited in the ANOVA section)</li>
<li>So if the SEMs for different treatments vary, then it must be due to the sample size in each group differing</li>
<li>But in the case of Darwin’s maize data, each group was comprised of 15 plants</li>
<li>Since both groups had an equal number of biological reps and the <code><a href="https://rdrr.io/r/stats/lm.html">lm()</a></code> was used, then we didn’t have to relevel the groups because we could have already known that the SEMs of the groups would be the same</li>
</ul>
</li>
</ul>
</div>
<div id="assumption-checking" class="section level2" number="6.7">
<h2>
<span class="header-section-number">6.7</span> Assumption checking<a class="anchor" aria-label="anchor" href="#assumption-checking"><i class="fas fa-link"></i></a>
</h2>
<ul>
<li>The objective here is to assess that the assumptions that the unexplained variations in the two treatment groups are approximately normal are are equal in their variability</li>
<li>It is recommended to plot the residual differences to assess this</li>
<li>Residuals are the differences between the observed values (heights) and the ‘fitted’ values which are predicted by the linear model</li>
<li>This assumption of approximate normality applies here because linear models use the normal distribution as a model for the variabiliity
<ul>
<li>This is where measures of precision (SEs) and confidence (CIs) are derived from</li>
</ul>
</li>
<li>The assumption of approximately equal variance follows from the use of a single pooled estimate of variance across all treatment groups</li>
</ul>
<div id="normality" class="section level3" number="6.7.1">
<h3>
<span class="header-section-number">6.7.1</span> Normality<a class="anchor" aria-label="anchor" href="#normality"><i class="fas fa-link"></i></a>
</h3>
<ul>
<li>Check assumptions using the diagnostic plots using ggfortify -
<ul>
<li>Display the normal quantile (Q-Q) plot:</li>
</ul>
</li>
</ul>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">fig6_6</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html">autoplot</a></span><span class="op">(</span><span class="va">ls1</span>, 
                   which <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span>, <span class="co">#refers to which of the graphs you want displayed </span>
                                      <span class="co">#in this case it's it can be c(1,2,3,4) </span>
                   ncol <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="co">#sets the orientation in which the plots are displayed </span>
<span class="va">fig6_6</span></code></pre></div>
<div class="inline-figure"><img src="06_linear-models_files/figure-html/ls1-assumptions-06-1.png" width="672"></div>
<ul>
<li>fig6_6 takeaways:
<ul>
<li>This plot graphs the quantiles of the distribution of the residuals compared to the quantiles of a random sample of normally distributed numbers</li>
<li>The dotted diagnonal line represents that normal distribution</li>
<li>When most of the dots fall around the dotted line, they closely match the normal model</li>
<li>A large portion of the residuals are approximately normally distributed</li>
<li>The points that deviate from normal are at the extremes
<ul>
<li>This is not a surprise because we already know there are outliers in the data</li>
</ul>
</li>
<li>Overall, this assessment shows that data are not ideally normal, but not appropriate still</li>
</ul>
</li>
</ul>
</div>
<div id="equal-variance" class="section level3" number="6.7.2">
<h3>
<span class="header-section-number">6.7.2</span> Equal variance<a class="anchor" aria-label="anchor" href="#equal-variance"><i class="fas fa-link"></i></a>
</h3>
<ul>
<li>Two graphs to assess if the variances in the treatment groups are approximately equal:
<ul>
<li>Raw residuals plot (left) - positive and negative values</li>
<li>Standarized residuals plot (right) - positive values
<ul>
<li><span class="math inline">\(\sqrt|\frac{residuals}{residuals.SD}|\)</span></li>
</ul>
</li>
</ul>
</li>
</ul>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">fig6_7</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html">autoplot</a></span><span class="op">(</span><span class="va">ls1</span>, 
                   which <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">)</span>,
                   ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>
<span class="va">fig6_7</span></code></pre></div>
<div class="inline-figure"><img src="06_linear-models_files/figure-html/ls1-var-check-06-1.png" width="672"></div>
<ul>
<li>fig6_7:
<ul>
<li>The group with the higher fitted values is the outcrossed group, which has a higher mean height</li>
<li>These plots confirm our impressions of the raw data (see base_plot) that the cross pollinated treatment data are more variable, mainly due to the outlier values</li>
</ul>
</li>
</ul>
</div>
</div>
<div id="appendix-6b-robust-linear-models" class="section level2 unnumbered">
<h2>Appendix 6b: Robust linear models<a class="anchor" aria-label="anchor" href="#appendix-6b-robust-linear-models"><i class="fas fa-link"></i></a>
</h2>
<p>Robust linear model function (<code><a href="https://rdrr.io/pkg/MASS/man/rlm.html">rlm()</a></code>):</p>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/MASS/man/rlm.html">rlm</a></span><span class="op">(</span><span class="va">height</span> <span class="op">~</span> <span class="va">type</span>, data <span class="op">=</span> <span class="va">darwin</span><span class="op">)</span><span class="op">)</span> 
<span class="co">#&gt; </span>
<span class="co">#&gt; Call: rlm(formula = height ~ type, data = darwin)</span>
<span class="co">#&gt; Residuals:</span>
<span class="co">#&gt;     Min      1Q  Median      3Q     Max </span>
<span class="co">#&gt; -9.1542 -1.4374  0.2501  0.9469  2.6251 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Coefficients:</span>
<span class="co">#&gt;             Value   Std. Error t value</span>
<span class="co">#&gt; (Intercept) 17.7499  0.6362    27.8989</span>
<span class="co">#&gt; typeCross    3.4043  0.8998     3.7836</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Residual standard error: 1.646 on 28 degrees of freedom</span></code></pre></div>
</div>
<div id="appendix-6c-exercise" class="section level2 unnumbered">
<h2>Appendix 6c: Exercise<a class="anchor" aria-label="anchor" href="#appendix-6c-exercise"><i class="fas fa-link"></i></a>
</h2>
<p>Repeat analysis with Darwin’s mignonette data…</p>
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">mignonette</span><span class="op">)</span>
<span class="co">#&gt; 'data.frame':    24 obs. of  2 variables:</span>
<span class="co">#&gt;  $ cross: num  21 14.2 19.1 7 15.1 ...</span>
<span class="co">#&gt;  $ self : num  12.9 16 11.9 15.2 19.1 ...</span></code></pre></div>
<ul>
<li>mignonette data is in wide form, but I want to make the pollination type a variable</li>
</ul>
<p>Add two variables for the pollination type:</p>
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mignonette</span><span class="op">$</span><span class="va">type1</span> <span class="op">&lt;-</span> <span class="st">"type_cross"</span>
<span class="va">mignonette</span><span class="op">$</span><span class="va">type2</span> <span class="op">&lt;-</span> <span class="st">"type_self"</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">mignonette</span><span class="op">)</span>
<span class="co">#&gt;    cross   self      type1     type2</span>
<span class="co">#&gt; 1 21.000 12.875 type_cross type_self</span>
<span class="co">#&gt; 2 14.250 16.000 type_cross type_self</span>
<span class="co">#&gt; 3 19.125 11.875 type_cross type_self</span>
<span class="co">#&gt; 4  7.000 15.250 type_cross type_self</span>
<span class="co">#&gt; 5 15.125 19.125 type_cross type_self</span>
<span class="co">#&gt; 6 20.500 12.500 type_cross type_self</span></code></pre></div>
<p>Combine type1 and type2 variables into one new column - type:</p>
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">df.new</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/pkg/reshape2/man/melt.html">melt</a></span><span class="op">(</span><span class="va">mignonette</span>, id.var <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'type1'</span>,<span class="st">'type2'</span><span class="op">)</span>, variable.name <span class="op">=</span> <span class="st">'type'</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">df.new</span><span class="op">)</span> 
<span class="co">#&gt;        type1     type2  type  value</span>
<span class="co">#&gt; 1 type_cross type_self cross 21.000</span>
<span class="co">#&gt; 2 type_cross type_self cross 14.250</span>
<span class="co">#&gt; 3 type_cross type_self cross 19.125</span>
<span class="co">#&gt; 4 type_cross type_self cross  7.000</span>
<span class="co">#&gt; 5 type_cross type_self cross 15.125</span>
<span class="co">#&gt; 6 type_cross type_self cross 20.500</span></code></pre></div>
<p>Subset this dataframe and change one of the variable names:</p>
<div class="sourceCode" id="cb55"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mignonette2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">df.new</span>, <span class="op">-</span><span class="va">type1</span> <span class="op">&amp;</span> <span class="op">-</span><span class="va">type2</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">mignonette2</span><span class="op">)</span>
<span class="co">#&gt;    type  value</span>
<span class="co">#&gt; 1 cross 21.000</span>
<span class="co">#&gt; 2 cross 14.250</span>
<span class="co">#&gt; 3 cross 19.125</span>
<span class="co">#&gt; 4 cross  7.000</span>
<span class="co">#&gt; 5 cross 15.125</span>
<span class="co">#&gt; 6 cross 20.500</span>

<span class="va">mignonette2</span><span class="op">$</span><span class="va">height</span> <span class="op">&lt;-</span> <span class="va">mignonette2</span><span class="op">$</span><span class="va">value</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">mignonette2</span><span class="op">)</span>
<span class="co">#&gt;    type  value height</span>
<span class="co">#&gt; 1 cross 21.000 21.000</span>
<span class="co">#&gt; 2 cross 14.250 14.250</span>
<span class="co">#&gt; 3 cross 19.125 19.125</span>
<span class="co">#&gt; 4 cross  7.000  7.000</span>
<span class="co">#&gt; 5 cross 15.125 15.125</span>
<span class="co">#&gt; 6 cross 20.500 20.500</span></code></pre></div>
<p>Create scatter plot:</p>
<div class="sourceCode" id="cb56"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">base_plot</span><span class="op">&lt;-</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">mignonette2</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">type</span>, y <span class="op">=</span> <span class="va">height</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>                    
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span>
<span class="va">base_plot</span> <span class="co"># there are no outliers</span></code></pre></div>
<div class="inline-figure"><img src="06_linear-models_files/figure-html/scatterp-mig-06-1.png" width="672"></div>
<p>Change height to numeric object:</p>
<div class="sourceCode" id="cb57"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mignonette2</span><span class="op">$</span><span class="va">height</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">mignonette2</span><span class="op">$</span><span class="va">height</span><span class="op">)</span> 
<span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">mignonette2</span><span class="op">)</span>
<span class="co">#&gt; 'data.frame':    48 obs. of  3 variables:</span>
<span class="co">#&gt;  $ type  : Factor w/ 2 levels "cross","self": 1 1 1 1 1 1 1 1 1 1 ...</span>
<span class="co">#&gt;  $ value : num  21 14.2 19.1 7 15.1 ...</span>
<span class="co">#&gt;  $ height: num  21 14.2 19.1 7 15.1 ...</span></code></pre></div>
<p>Use wide-format dataframe now for some calculation:</p>
<div class="sourceCode" id="cb58"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mignonette</span><span class="op">$</span><span class="va">difference</span> <span class="op">&lt;-</span> <span class="va">mignonette</span><span class="op">$</span><span class="va">cross</span> <span class="op">-</span> <span class="va">mignonette</span><span class="op">$</span><span class="va">self</span> </code></pre></div>
<p>Calculuate mean, SD, and standard error:</p>
<div class="sourceCode" id="cb59"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mig.mean</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">mignonette</span><span class="op">$</span><span class="va">difference</span><span class="op">)</span> 
<span class="va">mig.sd</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">mignonette</span><span class="op">$</span><span class="va">difference</span><span class="op">)</span>
<span class="va">mig.se</span> <span class="op">&lt;-</span> <span class="va">mig.sd</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fl">12</span><span class="op">)</span></code></pre></div>
<p>Create linear model:</p>
<div class="sourceCode" id="cb60"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mig_ls</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">value</span> <span class="op">~</span> <span class="va">type</span>,data <span class="op">=</span> <span class="va">mignonette2</span><span class="op">)</span></code></pre></div>
<p>Summarize the mig model:</p>
<div class="sourceCode" id="cb61"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/arm/man/display.html">display</a></span><span class="op">(</span><span class="va">mig_ls</span><span class="op">)</span>
<span class="co">#&gt; lm(formula = value ~ type, data = mignonette2)</span>
<span class="co">#&gt;             coef.est coef.se</span>
<span class="co">#&gt; (Intercept) 17.18     0.82  </span>
<span class="co">#&gt; typeself    -2.56     1.16  </span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; n = 48, k = 2</span>
<span class="co">#&gt; residual sd = 4.00, R-Squared = 0.10</span></code></pre></div>
<p>Calculate 95% CI for the model:</p>
<div class="sourceCode" id="cb62"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/confint.html">confint</a></span><span class="op">(</span><span class="va">mig_ls</span><span class="op">)</span>
<span class="co">#&gt;                 2.5 %     97.5 %</span>
<span class="co">#&gt; (Intercept) 15.531838 18.8223283</span>
<span class="co">#&gt; typeself    -4.884019 -0.2305639</span></code></pre></div>
<p>Plot model on a number line:</p>
<div class="sourceCode" id="cb63"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mig_NL</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/arm/man/coefplot.html">coefplot</a></span><span class="op">(</span><span class="va">mig_ls</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">5</span>,<span class="fl">0</span><span class="op">)</span><span class="op">)</span> </code></pre></div>
<div class="inline-figure"><img src="06_linear-models_files/figure-html/mig-95CI-NL-06-1.png" width="672"></div>
<ul>
<li>CI does not contain zero, we can reject the null hypothesis at a 95% CI</li>
</ul>
<p>Now create model at a 99% CI:</p>
<div class="sourceCode" id="cb64"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/confint.html">confint</a></span><span class="op">(</span><span class="va">mig_ls</span>, level <span class="op">=</span> <span class="fl">0.99</span><span class="op">)</span>
<span class="co">#&gt;                0.5 %     99.5 %</span>
<span class="co">#&gt; (Intercept) 14.98085 19.3733201</span>
<span class="co">#&gt; typeself    -5.66324  0.5486562</span></code></pre></div>
<ul>
<li>now the 99% CI does contain zero, so we will fail to reject the NH at this level</li>
</ul>
<p>Check some diagnostics, starting with the normal q-q plot:</p>
<div class="sourceCode" id="cb65"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html">autoplot</a></span><span class="op">(</span><span class="va">mig_ls</span>, which <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span>, ncol<span class="op">=</span><span class="fl">1</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="06_linear-models_files/figure-html/mig-QQ-06-1.png" width="672"></div>
<ul>
<li>since most of the points are on or near the dotted line, the data seem to fit the model appropriately</li>
</ul>
<p>Next, the residual variance plots:</p>
<div class="sourceCode" id="cb66"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html">autoplot</a></span><span class="op">(</span><span class="va">mig_ls</span>, which <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">)</span>, ncol<span class="op">=</span><span class="fl">2</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="06_linear-models_files/figure-html/mig-vars-06-1.png" width="672"></div>
<ul>
<li>the variances look comparable</li>
</ul>
</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="estimation.html"><span class="header-section-number">5</span> Estimation</a></div>
<div class="next"><a href="regression.html"><span class="header-section-number">7</span> Regression</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#linear-models"><span class="header-section-number">6</span> Linear models</a></li>
<li><a class="nav-link" href="#introduction-3"><span class="header-section-number">6.1</span> Introduction</a></li>
<li><a class="nav-link" href="#a-linear-model-analysis-for-comparing-groups"><span class="header-section-number">6.2</span> A linear model analysis for comparing groups</a></li>
<li><a class="nav-link" href="#standard-error-of-the-difference"><span class="header-section-number">6.3</span> Standard error of the difference</a></li>
<li><a class="nav-link" href="#confidence-intervals-1"><span class="header-section-number">6.4</span> Confidence intervals</a></li>
<li><a class="nav-link" href="#answering-darwins-question"><span class="header-section-number">6.5</span> Answering Darwin’s question</a></li>
<li><a class="nav-link" href="#relevelling-to-get-the-other-treatment-mean-and-standard-error"><span class="header-section-number">6.6</span> Relevelling to get the other treatment mean and standard error</a></li>
<li>
<a class="nav-link" href="#assumption-checking"><span class="header-section-number">6.7</span> Assumption checking</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#normality"><span class="header-section-number">6.7.1</span> Normality</a></li>
<li><a class="nav-link" href="#equal-variance"><span class="header-section-number">6.7.2</span> Equal variance</a></li>
</ul>
</li>
<li><a class="nav-link" href="#appendix-6b-robust-linear-models">Appendix 6b: Robust linear models</a></li>
<li><a class="nav-link" href="#appendix-6c-exercise">Appendix 6c: Exercise</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/apicellap/NSwR.git/blob/master/06_linear-models.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/apicellap/NSwR.git/edit/master/06_linear-models.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>A Guide to The New Statistics with R</strong>" was written by Pete Apicella. It was last built on 2022-07-19.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
