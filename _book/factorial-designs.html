<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 12 Factorial designs | A Guide to The New Statistics with R</title>
<meta name="author" content="Pete Apicella">
<meta name="generator" content="bookdown 0.27 with bs4_book()">
<meta property="og:title" content="Chapter 12 Factorial designs | A Guide to The New Statistics with R">
<meta property="og:type" content="book">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 12 Factorial designs | A Guide to The New Statistics with R">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.3.1/transition.js"></script><script src="libs/bs3compat-0.3.1/tabs.js"></script><script src="libs/bs3compat-0.3.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<link rel="stylesheet" href="style.css">
<meta name="description" content='12.1 Introduction For experimental designs that have two categorical explanatory variables Can look at interaction effects between the variables install.packages("arm", repos =...'>
<meta property="og:description" content='12.1 Introduction For experimental designs that have two categorical explanatory variables Can look at interaction effects between the variables install.packages("arm", repos =...'>
<meta name="twitter:description" content='12.1 Introduction For experimental designs that have two categorical explanatory variables Can look at interaction effects between the variables install.packages("arm", repos =...'>
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">A Guide to The New Statistics with R</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">About</a></li>
<li><a class="" href="introduction.html"><span class="header-section-number">1</span> Introduction</a></li>
<li><a class="" href="motivation.html"><span class="header-section-number">2</span> Motivation</a></li>
<li><a class="" href="description.html"><span class="header-section-number">3</span> Description</a></li>
<li><a class="" href="reproducible-research.html"><span class="header-section-number">4</span> Reproducible Research</a></li>
<li><a class="" href="estimation.html"><span class="header-section-number">5</span> Estimation</a></li>
<li><a class="" href="linear-models.html"><span class="header-section-number">6</span> Linear models</a></li>
<li><a class="" href="regression.html"><span class="header-section-number">7</span> Regression</a></li>
<li><a class="" href="prediction.html"><span class="header-section-number">8</span> Prediction</a></li>
<li><a class="" href="testing.html"><span class="header-section-number">9</span> Testing</a></li>
<li><a class="" href="intervals.html"><span class="header-section-number">10</span> Intervals</a></li>
<li><a class="" href="analysis-of-variance.html"><span class="header-section-number">11</span> Analysis of Variance</a></li>
<li><a class="active" href="factorial-designs.html"><span class="header-section-number">12</span> Factorial designs</a></li>
<li><a class="" href="analysis-of-covariance.html"><span class="header-section-number">13</span> Analysis of Covariance</a></li>
<li><a class="" href="linear-model-complexities.html"><span class="header-section-number">14</span> Linear Model Complexities</a></li>
<li><a class="" href="generalized-linear-models-glms.html"><span class="header-section-number">15</span> Generalized Linear Models (GLMs)</a></li>
<li><a class="" href="glms-for-count-data.html"><span class="header-section-number">16</span> GLMs for Count Data</a></li>
<li><a class="" href="binomial-glms.html"><span class="header-section-number">17</span> Binomial GLMs</a></li>
<li><a class="" href="glms-for-binary-data.html"><span class="header-section-number">18</span> GLMs for binary data</a></li>
<li><a class="" href="conclusions.html"><span class="header-section-number">19</span> Conclusions</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/apicellap/NSwR.git">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="factorial-designs" class="section level1" number="12">
<h1>
<span class="header-section-number">12</span> Factorial designs<a class="anchor" aria-label="anchor" href="#factorial-designs"><i class="fas fa-link"></i></a>
</h1>
<div id="introduction-6" class="section level2" number="12.1">
<h2>
<span class="header-section-number">12.1</span> Introduction<a class="anchor" aria-label="anchor" href="#introduction-6"><i class="fas fa-link"></i></a>
</h2>
<ul>
<li>For experimental designs that have two categorical explanatory variables</li>
<li>Can look at interaction effects between the variables</li>
</ul>
<div class="sourceCode" id="cb146"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"arm"</span>,  repos <span class="op">=</span> <span class="st">"https://cran.us.r-project.org"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"ggplot2"</span>,  repos <span class="op">=</span> <span class="st">"https://cran.us.r-project.org"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"cowplot"</span>,  repos <span class="op">=</span> <span class="st">"https://cran.us.r-project.org"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"patchwork"</span>,  repos <span class="op">=</span> <span class="st">"https://cran.us.r-project.org"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"dplyr"</span>,  repos <span class="op">=</span> <span class="st">"https://cran.us.r-project.org"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"readr"</span>,  repos <span class="op">=</span> <span class="st">"https://cran.us.r-project.org"</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb147"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://CRAN.R-project.org/package=arm">arm</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://wilkelab.org/cowplot/">cowplot</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://patchwork.data-imaginist.com">patchwork</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://readr.tidyverse.org">readr</a></span><span class="op">)</span></code></pre></div>
</div>
<div id="factorial-designs-1" class="section level2" number="12.2">
<h2>
<span class="header-section-number">12.2</span> Factorial designs<a class="anchor" aria-label="anchor" href="#factorial-designs-1"><i class="fas fa-link"></i></a>
</h2>
<ul>
<li>Fully factorial designs analyze for interactions by applying two or more treatments (factors) in all possible combinations</li>
<li>The effects of these treatments can be analyzed by treatment alone and in combination with other treatments</li>
<li>This example dataset in this chapter comes from a peer-reviewed publication (Hautier et al. 2009) in which the response of net aboveground plant biomass in grassland plots is being evaluated when treated with fertilizer and light</li>
<li>The dataframe encompasses two variables (factors) and each factor has two levels (i.e. with or without fertilizer)
<ul>
<li>There are four possible treatment combinations</li>
</ul>
</li>
<li>We want to determine if there is an interaction between the addition of light and fertilizer treatment together
<ul>
<li>It could be a negative interaction in which the addition of fertilizer creates a canopy that shades out the understory</li>
<li>It could be a positive interaction in which there is a synergistic effect on grassland productivity in terms of biomass</li>
</ul>
</li>
</ul>
<p>Load data and create dataframe:</p>
<div class="sourceCode" id="cb148"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">urlfile</span><span class="op">=</span><span class="st">"https://raw.githubusercontent.com/apicellap/data/main/Data_Factorial.txt"</span>
<span class="va">fact</span><span class="op">&lt;-</span><span class="fu"><a href="https://readr.tidyverse.org/reference/read_table.html">read_table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/connections.html">url</a></span><span class="op">(</span><span class="va">urlfile</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; ── Column specification ────────────────────────────────────</span>
<span class="co">#&gt; cols(</span>
<span class="co">#&gt;   Fert = col_character(),</span>
<span class="co">#&gt;   Light = col_character(),</span>
<span class="co">#&gt;   FL = col_character(),</span>
<span class="co">#&gt;   Biomass.m2 = col_double()</span>
<span class="co">#&gt; )</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">fact</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 6 × 4</span>
<span class="co">#&gt;   Fert  Light FL    Biomass.m2</span>
<span class="co">#&gt;   &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;      &lt;dbl&gt;</span>
<span class="co">#&gt; 1 F-    L-    F-L-        254.</span>
<span class="co">#&gt; 2 F-    L-    F-L-        202 </span>
<span class="co">#&gt; 3 F-    L-    F-L-        392.</span>
<span class="co">#&gt; 4 F-    L-    F-L-        455.</span>
<span class="co">#&gt; 5 F-    L-    F-L-        359.</span>
<span class="co">#&gt; 6 F-    L-    F-L-        386.</span></code></pre></div>
<ul>
<li>this dataset:
<ul>
<li>control (no added fertilizer or light: F-, L-)</li>
<li>fertilizer only (F+, L-)</li>
<li>light only (F-, L+)</li>
<li>both fertilizer and light added simultaneously (F+, L+)</li>
<li>biomass is the response variable</li>
</ul>
</li>
</ul>
<div class="sourceCode" id="cb149"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">fact</span><span class="op">)</span>
<span class="co">#&gt; spec_tbl_df [64 × 4] (S3: spec_tbl_df/tbl_df/tbl/data.frame)</span>
<span class="co">#&gt;  $ Fert      : chr [1:64] "F-" "F-" "F-" "F-" ...</span>
<span class="co">#&gt;  $ Light     : chr [1:64] "L-" "L-" "L-" "L-" ...</span>
<span class="co">#&gt;  $ FL        : chr [1:64] "F-L-" "F-L-" "F-L-" "F-L-" ...</span>
<span class="co">#&gt;  $ Biomass.m2: num [1:64] 254 202 392 455 359 ...</span>
<span class="co">#&gt;  - attr(*, "spec")=</span>
<span class="co">#&gt;   .. cols(</span>
<span class="co">#&gt;   ..   Fert = col_character(),</span>
<span class="co">#&gt;   ..   Light = col_character(),</span>
<span class="co">#&gt;   ..   FL = col_character(),</span>
<span class="co">#&gt;   ..   Biomass.m2 = col_double()</span>
<span class="co">#&gt;   .. )</span></code></pre></div>
<div class="sourceCode" id="cb150"><pre class="downlit sourceCode r">
<code class="sourceCode R"> <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">fact</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">fact</span><span class="op">)</span> <span class="op">==</span> <span class="st">'Fert'</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">'fert_'</span>
 <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">fact</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">fact</span><span class="op">)</span> <span class="op">==</span> <span class="st">'Light'</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">'light_'</span>
 <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">fact</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">fact</span><span class="op">)</span> <span class="op">==</span> <span class="st">'FL'</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">'fl_'</span>
 <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">fact</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">fact</span><span class="op">)</span> <span class="op">==</span> <span class="st">'Biomass.m2'</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">'biomass'</span>
 <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">fact</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 6 × 4</span>
<span class="co">#&gt;   fert_ light_ fl_   biomass</span>
<span class="co">#&gt;   &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt;   &lt;dbl&gt;</span>
<span class="co">#&gt; 1 F-    L-     F-L-     254.</span>
<span class="co">#&gt; 2 F-    L-     F-L-     202 </span>
<span class="co">#&gt; 3 F-    L-     F-L-     392.</span>
<span class="co">#&gt; 4 F-    L-     F-L-     455.</span>
<span class="co">#&gt; 5 F-    L-     F-L-     359.</span>
<span class="co">#&gt; 6 F-    L-     F-L-     386.</span></code></pre></div>
<ul>
<li>There are two ways of looking at the data</li>
<li>if we focus on column fl_, then we can approach the dataset as if it were a one-way anova design
<ul>
<li>fl_ is an individual factor with four levels</li>
</ul>
</li>
<li>if we focus on the columns fert_ and light_, which have two levels each, then we approach the design as a factorial</li>
</ul>
<p>Generate some summary statistics about the response variable biomass:</p>
<div class="sourceCode" id="cb151"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">fact</span><span class="op">)</span>
<span class="co">#&gt;     fert_              light_              fl_           </span>
<span class="co">#&gt;  Length:64          Length:64          Length:64         </span>
<span class="co">#&gt;  Class :character   Class :character   Class :character  </span>
<span class="co">#&gt;  Mode  :character   Mode  :character   Mode  :character  </span>
<span class="co">#&gt;                                                          </span>
<span class="co">#&gt;                                                          </span>
<span class="co">#&gt;                                                          </span>
<span class="co">#&gt;     biomass     </span>
<span class="co">#&gt;  Min.   :152.3  </span>
<span class="co">#&gt;  1st Qu.:370.1  </span>
<span class="co">#&gt;  Median :425.9  </span>
<span class="co">#&gt;  Mean   :441.6  </span>
<span class="co">#&gt;  3rd Qu.:517.2  </span>
<span class="co">#&gt;  Max.   :750.4</span></code></pre></div>
</div>
<div id="comparing-three-or-more-groups" class="section level2" number="12.3">
<h2>
<span class="header-section-number">12.3</span> Comparing three or more groups<a class="anchor" aria-label="anchor" href="#comparing-three-or-more-groups"><i class="fas fa-link"></i></a>
</h2>
<ul>
<li>In this chapter, we will build up to a full factorial analysis</li>
<li>First we will perform a linear model analysis with two factors but no interaction
<ul>
<li>This will involve the untreated control (F-L-) and the fertilizer only (F+) and light only (L+) treatment</li>
</ul>
</li>
</ul>
<p>Subset the data to only look at the two invdividual treatments (they each encompass the control):</p>
<div class="sourceCode" id="cb152"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">subs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">fact</span>, <span class="va">fl_</span> <span class="op">!=</span> <span class="st">"F+L+"</span><span class="op">)</span> 
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">subs</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 6 × 4</span>
<span class="co">#&gt;   fert_ light_ fl_   biomass</span>
<span class="co">#&gt;   &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt;   &lt;dbl&gt;</span>
<span class="co">#&gt; 1 F-    L-     F-L-     254.</span>
<span class="co">#&gt; 2 F-    L-     F-L-     202 </span>
<span class="co">#&gt; 3 F-    L-     F-L-     392.</span>
<span class="co">#&gt; 4 F-    L-     F-L-     455.</span>
<span class="co">#&gt; 5 F-    L-     F-L-     359.</span>
<span class="co">#&gt; 6 F-    L-     F-L-     386.</span></code></pre></div>
<p>Generate some summary statistics for a quick data visualization:</p>
<div class="sourceCode" id="cb153"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">cntrl</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">subs</span>, <span class="va">fl_</span> <span class="op">==</span> <span class="st">"F-L-"</span><span class="op">)</span> 
<span class="va">lght</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">subs</span>, <span class="va">fl_</span> <span class="op">==</span> <span class="st">"F-L+"</span><span class="op">)</span>
<span class="va">fert</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">subs</span>, <span class="va">fl_</span> <span class="op">==</span> <span class="st">"F+L-"</span><span class="op">)</span> 

<span class="va">cntrl.mean</span><span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span>
         <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">cntrl</span>, <span class="va">fl_</span><span class="op">)</span>, 
         biomass <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">biomass</span><span class="op">)</span><span class="op">)</span> 
<span class="va">lght.mean</span><span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span>
         <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">lght</span>, <span class="va">fl_</span><span class="op">)</span>, 
         biomass <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">biomass</span><span class="op">)</span><span class="op">)</span> 
<span class="va">fert.mean</span><span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span>
         <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">fert</span>, <span class="va">fl_</span><span class="op">)</span>, 
         biomass <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">biomass</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>Visualize this subsetted data:</p>
<div class="sourceCode" id="cb154"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">xlabels</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Control \n (F-L-)"</span>, <span class="st">"Light only \n (F-L+)"</span>, <span class="st">"Fertilizer only \n (F+L-)"</span><span class="op">)</span> <span class="co">#the \n tells R to put the next bit of text on the next line </span>

<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">subs</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">fl_</span>, y <span class="op">=</span> <span class="va">biomass</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">subs</span>, shape <span class="op">=</span> <span class="fl">1</span>, size <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span> 
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">cntrl.mean</span>, color <span class="op">=</span> <span class="st">"red"</span>, size <span class="op">=</span> <span class="fl">4</span><span class="op">)</span> <span class="op">+</span> 
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">lght.mean</span>, color <span class="op">=</span> <span class="st">"red"</span>, size <span class="op">=</span> <span class="fl">4</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">fert.mean</span>, color <span class="op">=</span> <span class="st">"red"</span>, size <span class="op">=</span> <span class="fl">4</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_discrete.html">scale_x_discrete</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"F-L-"</span>, <span class="st">"F-L+"</span>, <span class="st">"F+L-"</span><span class="op">)</span>,
                   labels <span class="op">=</span> <span class="va">xlabels</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">""</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="012_factorial-designs_files/figure-html/unnamed-chunk-9-1.png" width="672"></div>
<ul>
<li>Based on Figure 12.1, there might be an effect of fertilizer relative to the control
<ul>
<li>I can’t make a guess if there is an effect of the light only treatment based on this graph</li>
</ul>
</li>
<li>But this graph doesn’t tell us if there are outliers</li>
</ul>
<p>Quick check for outliers:</p>
<div class="sourceCode" id="cb155"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">subs</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">fl_</span>, y <span class="op">=</span> <span class="va">biomass</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>  
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_discrete.html">scale_x_discrete</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"F-L-"</span>, <span class="st">"F-L+"</span>, <span class="st">"F+L-"</span><span class="op">)</span>,
                   labels <span class="op">=</span> <span class="va">xlabels</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">""</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="012_factorial-designs_files/figure-html/unnamed-chunk-10-1.png" width="672"></div>
<p>Create a linear model (one factor with three levels)</p>
<div class="sourceCode" id="cb156"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mod1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">biomass</span> <span class="op">~</span> <span class="va">fl_</span>, data <span class="op">=</span> <span class="va">subs</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/arm/man/display.html">display</a></span><span class="op">(</span><span class="va">mod1</span><span class="op">)</span>
<span class="co">#&gt; lm(formula = biomass ~ fl_, data = subs)</span>
<span class="co">#&gt;             coef.est coef.se</span>
<span class="co">#&gt; (Intercept) 355.79    21.41 </span>
<span class="co">#&gt; fl_F-L+      30.12    30.27 </span>
<span class="co">#&gt; fl_F+L-      93.69    30.27 </span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; n = 48, k = 3</span>
<span class="co">#&gt; residual sd = 85.63, R-Squared = 0.18</span></code></pre></div>
<ul>
<li>This model treats the design as a one-way anova by using a single factor
<ul>
<li>(Intercept) has an actual value of the mean for F-L-
<ul>
<li>Has mean biomass of <span class="math inline">\(356 g\)</span> with a standard error of <span class="math inline">\(21 \;g\)</span>
</li>
</ul>
</li>
<li>fl_F-L+ is the difference between the mean of this factor and the intercept
<ul>
<li>Has a difference (relative to the control) of <span class="math inline">\(30 g\)</span> with a standard error of <span class="math inline">\(30 \;g\)</span>
</li>
</ul>
</li>
<li>fl_F+L- is the difference between the mean of this factor and the intercept
<ul>
<li>Has a difference (relative to the control) of <span class="math inline">\(94 g\)</span> with a standard error of <span class="math inline">\(30 \;g\)</span>
<ul>
<li>Signal seems to outweigh the noise here as the difference is about 3x higher than its SED</li>
</ul>
</li>
<li>The fertilizer only treatment has a difference of the mean of <span class="math inline">\(60 \;g\)</span> higher than the light only treatment relative to the control</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>Visualize the treatment differences:</p>
<div class="sourceCode" id="cb157"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">fig12_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/arm/man/coefplot.html">coefplot</a></span><span class="op">(</span><span class="va">mod1</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="012_factorial-designs_files/figure-html/unnamed-chunk-12-1.png" width="672"></div>
<ul>
<li>This plot shows that we fail to reject the null hypothesis for the light only treatment
<ul>
<li>We do not have confidence that the light only treatment produces a real effect in increasing biomass</li>
</ul>
</li>
<li>However the the null hypothesis can be rejected for the fertilizer only treatment at the 95% CI</li>
</ul>
</div>
<div id="two-way-anova-no-interaction" class="section level2" number="12.4">
<h2>
<span class="header-section-number">12.4</span> Two-way ANOVA (no interaction)<a class="anchor" aria-label="anchor" href="#two-way-anova-no-interaction"><i class="fas fa-link"></i></a>
</h2>
<ul>
<li>In the next step towards the full factorial analysis, we can fit a model with two factors (light_ and fert_)</li>
<li>This does not allow for an interaction analysis</li>
</ul>
<p>Create a model for two factors (two way anova without interaction):</p>
<div class="sourceCode" id="cb158"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/arm/man/display.html">display</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">biomass</span> <span class="op">~</span> <span class="va">light_</span> <span class="op">+</span> <span class="va">fert_</span>, data <span class="op">=</span> <span class="va">subs</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; lm(formula = biomass ~ light_ + fert_, data = subs)</span>
<span class="co">#&gt;             coef.est coef.se</span>
<span class="co">#&gt; (Intercept) 355.79    21.41 </span>
<span class="co">#&gt; light_L+     30.12    30.27 </span>
<span class="co">#&gt; fert_F+      93.69    30.27 </span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; n = 48, k = 3</span>
<span class="co">#&gt; residual sd = 85.63, R-Squared = 0.18</span></code></pre></div>
<ul>
<li>The output is exactly the same as the last model, which was the one way anova but for the fl_ factor with 4 levels</li>
<li>Here though, the fertilizer and light treatment variables have both separately been compared with the control</li>
<li>There is a third comparison that could be made and that is one between the light and fertilizer treatments
<ul>
<li>But there are more possible pairwise comparisons that can be made than we have degrees of freedom (three treatment levels gives us two degrees of freedom (n-1 = df))</li>
</ul>
</li>
<li>R has picked the control (fl_F-L-) as the reference/intercept. If it did not do this we could use the relevel function to restructure</li>
<li>If we specify some <em>a priori</em> comparisons that ask the major questions while staying within the limits of the degrees of freedom we have at our disposal then making adjustments for multiple comparisons can be avoided (avoid because they tend to generate false positives)</li>
</ul>
</div>
<div id="additive-treatment-effects" class="section level2" number="12.5">
<h2>
<span class="header-section-number">12.5</span> Additive treatment effects<a class="anchor" aria-label="anchor" href="#additive-treatment-effects"><i class="fas fa-link"></i></a>
</h2>
<ul>
<li>To be able to measure interactive effects, we need to be able to compare the effect of the the combined treatment (i.e fertilizer plus light treatment) with what we would expect if there were no interaction
<ul>
<li>a factorial anova creates this no-interaction scenario by assuming that treatment effects are independent and therefore additive
<ul>
<li>if one treatment has an effect size of A</li>
<li>and another treatment has an effect size of B</li>
<li>then a linear model anova testing the combination would predict the result to be A + B</li>
<li>in terms of this data that would mean:</li>
</ul>
</li>
</ul>
</li>
</ul>
<div class="sourceCode" id="cb159"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">mod1</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">+</span> <span class="co">#the coefficient of fl_F-L+   (30 g)          - the difference between the mean of F-L+ and the mean of the intercept </span>
  <span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">mod1</span><span class="op">)</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span> <span class="co">#the coefficient of fl_F+L-   (94 g)          - the difference between the mean of F+L- and the mean of the intercept </span>
<span class="co">#&gt;  fl_F-L+ </span>
<span class="co">#&gt; 123.8187</span></code></pre></div>
<ul>
<li>123.8 g represents the combined, additive expected effect of these two treatments (Light alone and fertilizer alone)
<ul>
<li>This is a difference</li>
<li>So if the control had a coefficient of 100 g, the combined F+L+ treatment would produce biomass of 223.8 g</li>
</ul>
</li>
</ul>
<div class="sourceCode" id="cb160"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">mod1</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="co">#the coefficient of Intercept (fl_F-L-) - the mean of the intercept </span>
<span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">mod1</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">+</span> <span class="co">#the coefficient of fl_F-L+             - the difference between the mean of F-L+ and the mean of the intercept </span>
  <span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">mod1</span><span class="op">)</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span> <span class="co">#the coefficient of fl_F+L-             - the difference between the mean of F+L- and the mean of the intercept </span>
<span class="co">#&gt; (Intercept) </span>
<span class="co">#&gt;    479.6125</span></code></pre></div>
<ul>
<li>This is the additive prediction - the threshold above which must be passed for us to determine that there is an interaction effect of the fertilizer and light treatments combined</li>
</ul>
<p>Plot whole dataset:</p>
<div class="sourceCode" id="cb161"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">xlabels2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Control \n (F-L-)"</span>, <span class="st">"Light only \n (F-L+)"</span>, <span class="st">"Fertilizer only \n (F+L-)"</span>, <span class="st">"Fertilizer &amp; Light \n (F+L+)"</span><span class="op">)</span> 
<span class="va">ylabel</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"Aboveground biomass (g m"</span><span class="op">^</span><span class="st">"-2"</span>,<span class="st">")"</span><span class="op">)</span><span class="op">)</span>
<span class="va">fig12_3</span> <span class="op">&lt;-</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">fact</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">fl_</span>, y <span class="op">=</span> <span class="va">biomass</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">fact</span>, shape <span class="op">=</span> <span class="fl">1</span>, size <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_discrete.html">scale_x_discrete</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"F-L-"</span>, <span class="st">"F-L+"</span>, <span class="st">"F+L-"</span>, <span class="st">"F+L+"</span><span class="op">)</span>,
                   labels <span class="op">=</span> <span class="va">xlabels2</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">""</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="va">ylabel</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>
    limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">800</span><span class="op">)</span>,
    breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">800</span>, by <span class="op">=</span> <span class="fl">50</span><span class="op">)</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">479.6125</span>, color <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span> <span class="op">+</span> <span class="co">#add horizontal line at this y position - represents the additive prediction </span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/stat_summary.html">stat_summary</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="va">mean</span>, geom <span class="op">=</span> <span class="st">"point"</span>, color <span class="op">=</span> <span class="st">"red"</span>, shape <span class="op">=</span> <span class="fl">18</span>, size <span class="op">=</span> <span class="fl">4</span><span class="op">)</span> <span class="op">+</span> <span class="co">#calculate statistics (in this case the only mean) across all four levels of the categorical variable, fl_</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span>
<span class="va">fig12_3</span></code></pre></div>
<div class="inline-figure"><img src="012_factorial-designs_files/figure-html/unnamed-chunk-16-1.png" width="672"></div>
<ul>
<li>The mean biomass for F+L+ is well above the threshold (blue line), so there is probably a positive interaction
<ul>
<li>To measure our confidence in this assertion, we have to create a linear model of the entire dataset</li>
<li>This will help us determine difference between the observed mean and the expected value relative to the background noise</li>
</ul>
</li>
</ul>
<p>Create a one-way ANOVA using the single factor with four levels:</p>
<div class="sourceCode" id="cb162"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mod2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">biomass</span> <span class="op">~</span> <span class="va">fl_</span>, data <span class="op">=</span> <span class="va">fact</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/arm/man/display.html">display</a></span><span class="op">(</span><span class="va">mod2</span><span class="op">)</span>
<span class="co">#&gt; lm(formula = biomass ~ fl_, data = fact)</span>
<span class="co">#&gt;             coef.est coef.se</span>
<span class="co">#&gt; (Intercept) 355.79    23.14 </span>
<span class="co">#&gt; fl_F-L+      30.12    32.72 </span>
<span class="co">#&gt; fl_F+L-      93.69    32.72 </span>
<span class="co">#&gt; fl_F+L+     219.22    32.72 </span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; n = 64, k = 4</span>
<span class="co">#&gt; residual sd = 92.56, R-Squared = 0.47</span></code></pre></div>
<ul>
<li>Author says we are first using the one-way anova on to evaluate the additive effect to understand the shortcomings of the test</li>
<li>Compared to mod1, the fourth treatment combination changes the pooled estimate of the variance (the residual error - “residual sd”) and therefore the standard errors change with it. From mod1, the residual sd increased by 6.93 units</li>
<li>coefficients
<ul>
<li>Intercept: displays the mean biomass for the untreated control treatment with the standard error of the mean (<span class="math inline">\(355.79 \pm 23.14 \;g\)</span>)</li>
<li>F-L+: displays the difference (of means) between the untreated control and the light only treatment (<span class="math inline">\(30.12 \pm 32.72 \;g\)</span>)</li>
<li>F+L-: displays the difference (of means) between the untreated control and the fertilizer only treatment (<span class="math inline">\(93.69 \pm 32.72 \;g\)</span>)</li>
<li>F+L+: displays the difference (of means) between the untreated control and the combined treatment (<span class="math inline">\(219.23 \pm 32.72 \;g\)</span>)</li>
</ul>
</li>
</ul>
<p>Visualize the coefficients by plotting them:</p>
<div class="sourceCode" id="cb163"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/arm/man/coefplot.html">coefplot</a></span><span class="op">(</span><span class="va">mod2</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="012_factorial-designs_files/figure-html/unnamed-chunk-18-1.png" width="672"></div>
<ul>
<li>Figure 12.4 takeaways:
<ul>
<li>There is no discernible effect of adding light</li>
<li>The addition of fertilizer alone has an effect and we can be confident of this because the lower bound is well into positive territory</li>
<li>For the same reasons, we can be confident that the combination treatment has an effect</li>
<li>The confidence intervals provide us with a range of plausible effect sizes that are consistent with the data (something using p values does not do)</li>
</ul>
</li>
<li>Adding light and fertilizer on their own increase biomass by 30 and 94 g, respectively
<ul>
<li>If the treatments acted independently and their effects were additive, we would expect an increase relative to the control of 124 g<br>
</li>
<li>It turns out that adding the treatments in combination increases biomass by approximately 220 g
<ul>
<li>This is substantially more than the mean effects found when either treatment is applied alone</li>
</ul>
</li>
</ul>
</li>
<li>The 220 g increase is almost 100 g higher than the additive prediction of 124 g</li>
<li>We could estimate the size of the interaction
<ul>
<li>This can be accomplished manually but with no standard error through a one way ANOVA</li>
</ul>
</li>
<li>Therefore we need a linear model that takes into account the factorial design</li>
</ul>
</div>
<div id="interactions-factorial-anova" class="section level2" number="12.6">
<h2>
<span class="header-section-number">12.6</span> Interactions: Factorial ANOVA<a class="anchor" aria-label="anchor" href="#interactions-factorial-anova"><i class="fas fa-link"></i></a>
</h2>
<ul>
<li>The factorial ANOVA allows for the estimation of the interactive effect directly and it will produce a standard error for this coefficient too</li>
<li>The standard error can be used to calculate a measure of confidence so that we can formally test the interaction effect</li>
</ul>
<p>Visualize the interaction:</p>
<div class="sourceCode" id="cb164"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">fig12_5a</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html">with</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">fact</span>, 
                 <span class="fu"><a href="https://rdrr.io/r/stats/interaction.plot.html">interaction.plot</a></span><span class="op">(</span><span class="va">light_</span>, <span class="co">#display on x axis</span>
                                  <span class="va">fert_</span>,  <span class="co">#display for lines</span>
                                  <span class="va">biomass</span><span class="op">)</span><span class="op">)</span> <span class="co">#the response variable </span></code></pre></div>
<div class="inline-figure"><img src="012_factorial-designs_files/figure-html/unnamed-chunk-19-1.png" width="672"></div>
<div class="sourceCode" id="cb165"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">fig12_5b</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html">with</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">fact</span>, 
                 <span class="fu"><a href="https://rdrr.io/r/stats/interaction.plot.html">interaction.plot</a></span><span class="op">(</span><span class="va">fert_</span>, <span class="va">light_</span>, <span class="va">biomass</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="012_factorial-designs_files/figure-html/unnamed-chunk-19-2.png" width="672"></div>
<div id="factorial-anova-in-r" class="section level3" number="12.6.1">
<h3>
<span class="header-section-number">12.6.1</span> Factorial ANOVA in R<a class="anchor" aria-label="anchor" href="#factorial-anova-in-r"><i class="fas fa-link"></i></a>
</h3>
<ul>
<li>The factorial anova allows for the direct estimation of the interactive effect and its standard error
<ul>
<li>The standard error can be used to measure our confidence around this asserted effect</li>
</ul>
</li>
</ul>
<p>Visualize the interaction in the data:</p>
<div class="sourceCode" id="cb166"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">fig12_5a</span> <span class="op">&lt;-</span> 
  <span class="fu"><a href="https://rdrr.io/r/base/with.html">with</a></span><span class="op">(</span>        <span class="co">#interaction.plot doesn't have an argument that lets you provide the dataframe so you have to do it using the with() function </span>
    data <span class="op">=</span> <span class="va">fact</span>, 
    <span class="fu"><a href="https://rdrr.io/r/stats/interaction.plot.html">interaction.plot</a></span><span class="op">(</span>
      <span class="va">fert_</span>,   <span class="co">#variable on the x axis </span>
      <span class="va">light_</span>,  <span class="co">#variable inscribed into the lines </span>
      <span class="va">biomass</span>, <span class="co">#response (y) variable </span>
      xlab <span class="op">=</span> <span class="st">"Fertilizer"</span>
    <span class="op">)</span>
<span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="012_factorial-designs_files/figure-html/unnamed-chunk-20-1.png" width="672"></div>
<div class="sourceCode" id="cb167"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">fig12_5b</span> <span class="op">&lt;-</span> 
  <span class="fu"><a href="https://rdrr.io/r/base/with.html">with</a></span><span class="op">(</span>        <span class="co">#interaction.plot doesn't have an argument that lets you provide the dataframe so you have to do it using the with() function </span>
    data <span class="op">=</span> <span class="va">fact</span>, 
    <span class="fu"><a href="https://rdrr.io/r/stats/interaction.plot.html">interaction.plot</a></span><span class="op">(</span>
      <span class="va">light_</span>,   <span class="co">#variable on the x axis </span>
      <span class="va">fert_</span>,  <span class="co">#variable inscribed into the lines </span>
      <span class="va">biomass</span>, <span class="co">#response (y) variable </span>
      xlab <span class="op">=</span> <span class="st">"Light"</span>
    <span class="op">)</span>
<span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="012_factorial-designs_files/figure-html/unnamed-chunk-20-2.png" width="672"></div>
</div>
<div id="factorial-anova-in-r-1" class="section level3" number="12.6.2">
<h3>
<span class="header-section-number">12.6.2</span> Factorial ANOVA in R<a class="anchor" aria-label="anchor" href="#factorial-anova-in-r-1"><i class="fas fa-link"></i></a>
</h3>
<p>Create model that takes into account the interaction:</p>
<div class="sourceCode" id="cb168"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mod3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">biomass</span> <span class="op">~</span> <span class="va">light_</span><span class="op">+</span> <span class="va">fert_</span> <span class="op">+</span> <span class="va">fert_</span><span class="op">:</span><span class="va">light_</span>, data <span class="op">=</span> <span class="va">fact</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/arm/man/display.html">display</a></span><span class="op">(</span><span class="va">mod3</span><span class="op">)</span>
<span class="co">#&gt; lm(formula = biomass ~ light_ + fert_ + fert_:light_, data = fact)</span>
<span class="co">#&gt;                  coef.est coef.se</span>
<span class="co">#&gt; (Intercept)      355.79    23.14 </span>
<span class="co">#&gt; light_L+          30.13    32.72 </span>
<span class="co">#&gt; fert_F+           93.69    32.72 </span>
<span class="co">#&gt; light_L+:fert_F+  95.41    46.28 </span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; n = 64, k = 4</span>
<span class="co">#&gt; residual sd = 92.56, R-Squared = 0.47</span></code></pre></div>
<ul>
<li>Table of coefficients</li>
<li>The factorial analysis has less power to estimate the interaction
<ul>
<li>This is evidenced by the fact that the light_L+:fert_F+ row has a larger SE than those of the other variables</li>
</ul>
</li>
<li>The interaction coef.se is larger than the standard errors for the main effects
<ul>
<li>This is because the test has less estimating power for the interaction</li>
</ul>
</li>
<li>It’s important to note that the coefficient for the last line is 95.41 because this is the difference between this mean and the mean for the control’s biomass
<ul>
<li>If the combined treatment had actually generated a biomass equal to the additive prediction (see blue line in fig12_3), which is:
<ul>
<li>The biomass of the control + the biomass increase due to fertilizer + biomass increcase due to light, then</li>
<li>Then the coefficient for light_L+:fert_F+ would be zero since there would be no difference between the mean of the control and the mean of the combined treatments</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>Visualize the coefficients table:</p>
<div class="sourceCode" id="cb169"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">fig12_6</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/arm/man/coefplot.html">coefplot</a></span><span class="op">(</span><span class="va">mod3</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="012_factorial-designs_files/figure-html/unnamed-chunk-22-1.png" width="672"></div>
<p>Calculate the mean biomass for the light only treatment:</p>
<div class="sourceCode" id="cb170"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">mod3</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="co">#coefficient of the intercept (this is the mean for the control)</span>
  <span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">mod3</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="co">#coefficient for light_L+ (this is the difference between the biomass means of the control and light)</span>
<span class="co">#&gt; (Intercept) </span>
<span class="co">#&gt;    385.9187</span></code></pre></div>
<p>Calculate the mean biomass for the fertilizer only treatment:</p>
<div class="sourceCode" id="cb171"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">mod3</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="co">#coefficient of the intercept (this is the mean for the control)</span>
  <span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">mod3</span><span class="op">)</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span> <span class="co">#coefficient for fert_F+ (this is the difference between the biomass means of the control and fertilizer treatment)</span>
<span class="co">#&gt; (Intercept) </span>
<span class="co">#&gt;    449.4875</span></code></pre></div>
<p>Calculate the mean biomass for the interaction treatment:</p>
<div class="sourceCode" id="cb172"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">mod3</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> 
  <span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">mod3</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">mod3</span><span class="op">)</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span> <span class="op">+</span> 
  <span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">mod3</span><span class="op">)</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span> <span class="co">#coefficient for light_L+:fert_F+ (this is the difference between the biomass means of the control and combination treatment) </span>
<span class="co">#&gt; (Intercept) </span>
<span class="co">#&gt;    575.0187</span></code></pre></div>
<ul>
<li>In the table of coefficients, the mean is given for the intercept (in this case, the control) and this coefficient has a corresponding standard error - the standard error of the mean (SEM)</li>
<li>The next two rows - for light_L+ and fert_F+ - also have coefficients
<ul>
<li>But these coefficients are differences between means (between the respective variable and the control)</li>
<li>These coefficient’s standard errors are the standard error of the difference (SED)</li>
</ul>
</li>
<li>The third row, which contains the interaction, also gives information for the interaction’s difference between the mean of the prediction and the mean of the control plus its corresponding SED</li>
</ul>
<p>Generate confidence intervals for these estimates:</p>
<div class="sourceCode" id="cb173"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/confint.html">confint</a></span><span class="op">(</span><span class="va">mod3</span><span class="op">)</span>
<span class="co">#&gt;                       2.5 %    97.5 %</span>
<span class="co">#&gt; (Intercept)      309.508816 402.07868</span>
<span class="co">#&gt; light_L+         -35.331781  95.58178</span>
<span class="co">#&gt; fert_F+           28.236969 159.15053</span>
<span class="co">#&gt; light_L+:fert_F+   2.836382 187.97612</span></code></pre></div>
<ul>
<li>Based on these CIs, the author suggests caution to not make the mistake of deciding that there is not significant effect of light since its interval contains zero</li>
<li>He goes on to say that if there is evidence that there is an interaction effect in the data between two or more treatments, then all of those treatments must be investigated thoroughly for their contribution</li>
<li>All treatments must be investigated even if a treatment’s main effect is non-significant</li>
</ul>
<p>Create a model (two way anova) that doesn’t evaluate the interaction:</p>
<div class="sourceCode" id="cb174"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mod4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">biomass</span> <span class="op">~</span> <span class="va">light_</span> <span class="op">+</span> <span class="va">fert_</span>, data <span class="op">=</span> <span class="va">fact</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb175"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/options.html">options</a></span><span class="op">(</span>show.signif.stars <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span><span class="va">mod3</span>, <span class="va">mod4</span><span class="op">)</span>
<span class="co">#&gt; Analysis of Variance Table</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model 1: biomass ~ light_ + fert_ + fert_:light_</span>
<span class="co">#&gt; Model 2: biomass ~ light_ + fert_</span>
<span class="co">#&gt;   Res.Df    RSS Df Sum of Sq      F  Pr(&gt;F)</span>
<span class="co">#&gt; 1     60 513998                            </span>
<span class="co">#&gt; 2     61 550407 -1    -36409 4.2501 0.04359</span></code></pre></div>
<ul>
<li>In this table, R renames the models that we cited in anova()</li>
<li>The function compares the two models using the f-test</li>
<li>The table involves:
<ul>
<li>The identity of the model (1 or 2)</li>
<li>The number of degrees of freedom</li>
<li>The residual sum of squares</li>
<li>Df - shows that 1 degree of freedom has been used</li>
<li>Sum of squares</li>
<li>
<strong>Probability value - shows that the null hypothesis can be rejected (just barely beneath the 0.05 threshold)</strong>
<ul>
<li>Author goes on to say later that it would be a mistake to focus solely on this p-value since the effect size is large
<ul>
<li>He is referring to the fact that the combined treatment of fertilizer + light led to substantially more biomass than expected when treatments were added in isolation</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>The <code><a href="https://rdrr.io/r/stats/add1.html">drop1()</a></code> function does this too but with a twist:</li>
</ul>
<div class="sourceCode" id="cb176"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/add1.html">drop1</a></span><span class="op">(</span><span class="va">mod3</span>, test <span class="op">=</span> <span class="st">"F"</span><span class="op">)</span>
<span class="co">#&gt; Single term deletions</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model:</span>
<span class="co">#&gt; biomass ~ light_ + fert_ + fert_:light_</span>
<span class="co">#&gt;              Df Sum of Sq    RSS    AIC F value  Pr(&gt;F)</span>
<span class="co">#&gt; &lt;none&gt;                    513998 583.43                </span>
<span class="co">#&gt; light_:fert_  1     36409 550407 585.81  4.2501 0.04359</span></code></pre></div>
<ul>
<li>The twist with <code><a href="https://rdrr.io/r/stats/add1.html">drop1()</a></code> is that it starts with the highest order (in this case, that’s the interaction)</li>
<li>Then if the highest order is significant then the analysis stops there
<ul>
<li>Authors says that it stops the analysis rather than “inappropriately” continuing to look at the main effects in the the presence of an interaction</li>
</ul>
</li>
<li>The <code><a href="https://rdrr.io/r/stats/add1.html">drop1()</a></code> function also provides the value of the Akaike information criterion (AIC) which can be used for model selection as an alternative to P-values - more on this later</li>
<li>The author goes on to say that if p-values are going to be provided, then to include more information such as what analysis was performed, the value of the test statistic, the exact value of P, and the number of degrees of freedom. This can be done like this:</li>
</ul>
<div class="inline-figure"><img src="fig_text_ch12.png" width="65%"></div>
<ul>
<li>Since the interaction effect is such a robust result, it might be misleading to say that the main effect of light is non-significant so instead the main effects of the individual treatments are not reported</li>
</ul>
</div>
</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="analysis-of-variance.html"><span class="header-section-number">11</span> Analysis of Variance</a></div>
<div class="next"><a href="analysis-of-covariance.html"><span class="header-section-number">13</span> Analysis of Covariance</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#factorial-designs"><span class="header-section-number">12</span> Factorial designs</a></li>
<li><a class="nav-link" href="#introduction-6"><span class="header-section-number">12.1</span> Introduction</a></li>
<li><a class="nav-link" href="#factorial-designs-1"><span class="header-section-number">12.2</span> Factorial designs</a></li>
<li><a class="nav-link" href="#comparing-three-or-more-groups"><span class="header-section-number">12.3</span> Comparing three or more groups</a></li>
<li><a class="nav-link" href="#two-way-anova-no-interaction"><span class="header-section-number">12.4</span> Two-way ANOVA (no interaction)</a></li>
<li><a class="nav-link" href="#additive-treatment-effects"><span class="header-section-number">12.5</span> Additive treatment effects</a></li>
<li>
<a class="nav-link" href="#interactions-factorial-anova"><span class="header-section-number">12.6</span> Interactions: Factorial ANOVA</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#factorial-anova-in-r"><span class="header-section-number">12.6.1</span> Factorial ANOVA in R</a></li>
<li><a class="nav-link" href="#factorial-anova-in-r-1"><span class="header-section-number">12.6.2</span> Factorial ANOVA in R</a></li>
</ul>
</li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/apicellap/NSwR.git/blob/master/012_factorial-designs.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/apicellap/NSwR.git/edit/master/012_factorial-designs.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>A Guide to The New Statistics with R</strong>" was written by Pete Apicella. It was last built on 2022-07-19.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
